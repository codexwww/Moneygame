<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Money Game</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #0f172a;
    color: white;
    display: flex;
}

.sidebar {
    width: 220px;
    background: #020617;
    height: 100vh;
    padding: 20px;
}

.menu-item {
    margin: 15px 0;
    cursor: pointer;
    color: #cbd5f5;
}
.menu-item:hover { color: #22c55e; }

.content {
    flex: 1;
    padding: 30px;
}

.card {
    background: #1e293b;
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 15px;
}

.action {
    display: flex;
    justify-content: space-between;
    cursor: pointer;
}

.up { color: #22c55e; }
.down { color: #ef4444; }

input {
    padding: 8px;
    width: 140px;
    margin-right: 10px;
}

button {
    padding: 8px 14px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    background: #22c55e;
    color: black;
}
</style>
</head>

<body>

<div class="sidebar">
    <h2>üí∞ Money Game</h2>
    <div class="menu-item" onclick="dashboard()">üè† Accueil</div>
    <div class="menu-item" onclick="investPage()">üìà Investir</div>
</div>

<div class="content" id="content"></div>

<script>
let argent = localStorage.getItem("argent")
    ? parseFloat(localStorage.getItem("argent"))
    : 10000;

let portfolio = localStorage.getItem("portfolio")
    ? JSON.parse(localStorage.getItem("portfolio"))
    : { 0:0, 1:0, 2:0 };

const actions = [
    { id:0, nom:"Alpha Corp", prix:100, prev:100, timer:rand() },
    { id:1, nom:"Beta Industries", prix:250, prev:250, timer:rand() },
    { id:2, nom:"Gamma Tech", prix:500, prev:500, timer:rand() }
];

function rand() {
    return Math.floor(Math.random()*5+1)*60;
}

function save() {
    localStorage.setItem("argent", argent);
    localStorage.setItem("portfolio", JSON.stringify(portfolio));
}

/* DASHBOARD */
function dashboard() {
    let totalInvesti = 0;
    actions.forEach(a => totalInvesti += portfolio[a.id] * a.prix);

    document.getElementById("content").innerHTML = `
        <h1>Tableau de bord</h1>
        <div class="card">üí∞ Argent disponible : ${argent.toFixed(2)} ‚Ç¨</div>
        <div class="card">üíº Valeur du portefeuille : ${totalInvesti.toFixed(2)} ‚Ç¨</div>
    `;
}

/* PAGE INVESTIR */
function investPage() {
    let html = `<h1>Investir</h1>`;
    actions.forEach(a => {
        let diff = (((a.prix - a.prev) / a.prev) * 100).toFixed(2);
        html += `
        <div class="card action" onclick="openAction(${a.id})">
            <div>
                <strong>${a.nom}</strong><br>
                <span class="${diff >= 0 ? "up":"down"}">
                    ${diff >= 0 ? "‚ñ≤":"‚ñº"} ${diff} %
                </span>
            </div>
            <div>‚è±Ô∏è ${a.timer}s</div>
        </div>`;
    });
    document.getElementById("content").innerHTML = html;
}

/* PAGE ACTION */
function openAction(id) {
    let a = actions[id];
    let parts = portfolio[id];

    document.getElementById("content").innerHTML = `
        <h1>${a.nom}</h1>

        <div class="card">üí≤ Prix : ${a.prix} ‚Ç¨</div>
        <div class="card">üì¶ Parts poss√©d√©es : ${parts.toFixed(4)}</div>
        <div class="card">‚è±Ô∏è Prochaine variation : ${a.timer}s</div>

        <div class="card">
            <input id="amount" type="number" placeholder="Montant ‚Ç¨">
            <br><br>
            <button onclick="buy(${id})">Investir</button>
            <button onclick="sell(${id})">R√©cup√©rer</button>
        </div>

        <button onclick="investPage()">‚¨Ö Retour</button>
    `;
}

/* ACHAT */
function buy(id) {
    let amount = parseFloat(document.getElementById("amount").value);
    let a = actions[id];

    if (!amount || amount > argent) {
        alert("Montant invalide");
        return;
    }

    let parts = amount / a.prix;
    portfolio[id] += parts;
    argent -= amount;
    save();
    openAction(id);
}

/* VENTE */
function sell(id) {
    let amount = parseFloat(document.getElementById("amount").value);
    let a = actions[id];
    let partsToSell = amount / a.prix;

    if (!amount || partsToSell > portfolio[id]) {
        alert("Montant invalide");
        return;
    }

    portfolio[id] -= partsToSell;
    argent += amount;
    save();
    openAction(id);
}

/* MARCH√â VIVANT */
setInterval(() => {
    actions.forEach(a => {
        a.timer--;
        if (a.timer <= 0) {
            a.prev = a.prix;
            a.prix = Math.max(10, Math.floor(a.prix * (1 + (Math.random()*0.2 - 0.1))));
            a.timer = rand();
        }
    });

    if (document.getElementById("content").innerHTML.includes("Investir")) {
        investPage();
    }
}, 1000);

/* START */
dashboard();
</script>

</body>
</html>
